---
title: "2022 March ICTF Writeup"
date: "2022-03-31T11:59:59.999Z"
description: "ICTF Writeup"
author: "ZyphenSVC"
slug: "posts/2022-03-31-htb-unicode"
---

> Forenote

```md
ICTF is a practice competition that does not equate to much except for practice. However, this does not mean they are all easy. These challenges are meant to simulate real ones, usage of websites, terminal, pwning, and so much more. All just for practice with the work and dedication of the board team. They generally release challenges once on the daily and reset the round every month. If you would like to join, click on the link below.
```

```md
Google's “20% Time”, inspired by Sergey Brin's and Larry Page's Montessori School experience, is a philosophy and policy that every Google employee spends 20% of their time (the equivalent of a full work day each week) working on ideas and projects that interest that employee. Ideas like Gmail, Google News, and AdSense have been developed from this working model. 

This website is a project I am working on in my senior English literature and composition course. During this project I will be spending 20% of my class time working on developing my idea through a progressive process to its final product. This website will be a space where I update visitors on the progress of my idea for this project. Thank you for visiting and I hope you follow along on my journey.

D’Onfro, Jillian. “The Truth about Google’s Famous ‘20% Time’ Policy.” Business Insider, Business Insider, 17 Apr. 2015, http://www.businessinsider.com/google-20-percent-time-policy-2015-4  
```

> <https://discord.gg/Z4Vn9bw2uX>

# Sanity Round Check

[Misc]

> Welcome to round 20!
>
> `ictf{w3lc0m3_t0_r0und_20!!}`

This is just a starting challenge for those new to understand how the round starts and how to submit flags.

> ictf{w3lc0m3_t0_r0und_20!!}

# Find Me!

> Somebody has been kidnapped and we managed to get a file of where he is. Your mission is to find where he is, flag is lat + long rounded to 2 decimal places eg - ictf{1.00_1.54}
>
> <https://imaginaryctf.org/f/HxV7Z>

![FindMe](./flag.png)

My goto reverse image searcher is a tool called duplichecker, which automatically uploads to google, bing, tineye, yandex, and etc. This leads me to the location of the image, which we can then search on google maps to get the significant figure of the longitude and latitude.

> ictf{42.63_12.11}

# Casework

> Oh no, I accidentally used windows, and now my encoded flag is case insensitive.
> 
> <https://imaginaryctf.org/f/67uR4>
> `awn0znsxdcdzx2u0czezcl90mf9ym2mwdmvyx3rong5faxrfczmzbxn9`

This challenge includes a base64 string that was made into complete lowercase. We have to be able to brute this in sets of four.

For those who dont know how base64 works, each four characters will encode a single ascii value. With this in mind, we could either create a script to bruteforce each of the four characters, or use a tool.

> <https://potatosfield.neocities.org/base64Brute.html>

> ictf{1t's_e4s13r_t0_r3c0ver_th4n_it_s33ms}

# Eye Sight

> Found this site but all it does is show a letter "i".
>
> <https://eye-sight.ictf.iciaran.com/>

When checking the source of the website, we are able to see a script encoded in base64.

```html
<body data-new-gr-c-s-check-loaded="8.896.0" data-gr-ext-installed="">
    <main>
        <h1 id="c">i</h1>
    </main>
    <script src="data:text/javascript;base64,bGV0IGY9ITA7Y29uc3Qgd2ViU29ja2V0PW5ldyBXZWJTb2NrZXQoIndzczovL2V5ZS1zaWdodC5pY3RmLmljaWFyYW4uY29tL3dzIik7d2ViU29ja2V0Lm9ubWVzc2FnZT1mdW5jdGlvbihlKXtpZihmKXtjb25zdCB0PUpTT04ucGFyc2UoZS5kYXRhKS5uZXh0O3dlYlNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtpbmRleDowLGtleTp0fSkpLGY9ITF9ZWxzZSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYyIpLmlubmVySFRNTD1KU09OLnBhcnNlKGUuZGF0YSkuY2hhcn07Cg=="></script>
</body>
```

When you decode this base64, you will get the following javascript.

```javascript
let f = !0;
const webSocket = new WebSocket("wss://eye-sight.ictf.iciaran.com/ws");
webSocket.onmessage = function(e) {
    if (f) {
        const t = JSON.parse(e.data).next;
        webSocket.send(JSON.stringify({
            index: 0,
            key: t
        })), f = !1
    } else document.getElementById("c").innerHTML = JSON.parse(e.data).char
};
```

We can then structure our code around this. We must add to the index, and use the next token as the key for the next index. 

```javascript
const ws = require("ws");
const websocket = new ws.WebSocket("wss://eye-sight.ictf.iciaran.com/ws");

let t;
let message;
let i = 0;

websocket.onmessage = function(e) {
    t = JSON.parse(e.data).next
    websocket.send(JSON.stringify({
        index: i,
        key: t
    }))
    t = JSON.parse(e.data).next
    i++
    message += JSON.parse(e.data).char
    console.log(message)
}
```

> ictf{3y3_5py_w17h_my_l1ttl3_i}

